# ì„¸ì¢…ëŒ€í•™êµ ë¸”ë™ë³´ë“œ í¬ë¡¤ë§

> - [ì°¸ê³  ë§í¬](https://taebbong.github.io/categories/%EA%B0%9C%EB%B0%9C/Web-Scraping-Crawling/)
> - [Selenium ì‚¬ìš©ë²•](https://greeksharifa.github.io/references/2020/10/30/python-selenium-usage/)

## Selenium ê¸°ë°˜ í¬ë¡¤ë§ ì—”ì§„ ì œì‘
> 1. [í˜ì´ì§€ ë¶ˆëŸ¬ì˜¤ê¸°](#1-í˜ì´ì§€-ë¶ˆëŸ¬ì˜¤ê¸°)
> 2. [ë¸”ë™ë³´ë“œ ë¡œê·¸ì¸](#2-ë¸”ë™ë³´ë“œ-ë¡œê·¸ì¸)
> 3. [ì½”ìŠ¤ ê³¼ëª© ê°€ì ¸ì˜¤ê¸°](#3-ì½”ìŠ¤-ê³¼ëª©-ê°€ì ¸ì˜¤ê¸°)
> 4. [ê° ê³¼ëª©ë³„ ê³µì§€ / ê³¼ì œ í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸°](#4-ê°-ê³¼ëª©ë³„-ê³µì§€--ê³¼ì œ-í˜ì´ì§€-ê°€ì ¸ì˜¤ê¸°)
> 5. [ê° ê³¼ëª©ë³„ ê³µì§€ / ê³¼ì œ í¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°](#5-ê°-ê³¼ëª©ë³„-ê³µì§€--ê³¼ì œ-í¬ìŠ¤íŠ¸-ê°€ì ¸ì˜¤ê¸°)
> 6. [ìµœì¢… ì½”ë“œ](#6-ìµœì¢…-ì½”ë“œ)

---


## 1. í˜ì´ì§€ ë¶ˆëŸ¬ì˜¤ê¸°

```py
from selenium import webdriver # ëª¨ë“ˆ ë¶ˆëŸ¬ì˜¤ê¸°

driver = webdriver.Chrome('í¬ë¡¬ ë“œë¼ì´ë²„ì˜ ì ˆëŒ€ ê²½ë¡œ')
url = 'https://portal.sejong.ac.kr/jsp/login/loginSSL.jsp?rtUrl=blackboard.sejong.ac.kr'
driver.get(url)

while(True):
    pass
```

ì´ë ‡ê²Œ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ì‹¤í–‰ì‹œí‚¤ë©´ ë¸”ë™ë³´ë“œ ë¡œê·¸ì¸ í™”ë©´ì´ ëœ¨ê²Œ ëœë‹¤.  
*(ë§ˆì§€ë§‰ `while`ë¬¸ì€ chromeì°½ì´ ìë™ ì¢…ë£Œë˜ëŠ” ì˜¤ë¥˜ë¥¼ ê²°í•˜ëŠ” ì½”ë“œì´ë‹¤. - ë°œìƒ ì´ìœ ë¥¼ ì˜ ëª¨ë¥´ê² ë‹¤ ğŸ˜¥)*

<br/>

## 2. ë¸”ë™ë³´ë“œ ë¡œê·¸ì¸

`<F12>` ê°œë°œì ë„êµ¬ë¥¼ ì‚¬ìš© !

<br/>

![image](https://user-images.githubusercontent.com/62230430/108622255-da2ac400-747a-11eb-8905-93b5601efe56.png)



- í‚¤ë³´ë“œ ë³´ì•ˆ í•´ì œ

ì„¸ì¢…ëŒ€í•™êµëŠ” ì°¸ê³ í•œ ì‚¬ì´íŠ¸ì™€ëŠ” ë‹¤ë¥´ê²Œ ë³´ì•ˆ í‚¤ë³´ë“œ ë³´ì•ˆì´ ìˆì–´ì„œ í•´ì œë¥¼ í•´ì¤˜ì•¼ í•œë‹¤.
ì´ ë•Œ, í‚¤ë³´ë“œ ë³´ì•ˆ ì²´í¬ë¥¼ í•´ì œí•˜ë©´ ì•Œë¦¼ì°½ì´ ëœ¨ê¸° ë•Œë¬¸ì— í™•ì¸ì„ ëˆŒëŸ¬ì¤˜ì•¼ ì œëŒ€ë¡œ ì‹¤í–‰ì´ ëœë‹¤.

```py
from selenium.webdriver.common.alert import Alert # ì•Œë¦¼ì°½ì„ ì œì–´í•˜ê¸° ìœ„í•´ import

driver.find_element_by_name('chkNos').click()
da = Alert(driver) # daì— Alert ê°ì²´ í• ë‹¹
da.accept() # í™•ì¸
```

<br/>


- ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸ key ì…ë ¥

```py
driver.find_element_by_name('inputì˜ name').send_keys('ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸ ì…ë ¥')
```

<br/>

- ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ 

ë¡œê·¸ì¸ ë²„íŠ¼ì„ ì°¾ì•„ì„œ, **ì˜¤ë¥¸ìª½ ë§ˆìš°ìŠ¤ > copy > copy by xpath**ë¥¼ í†µí•´ ë³µì‚¬í•œ ë’¤,  
`click()` í•¨ìˆ˜ë¥¼ í˜¸ì¶œ

```py
driver.find_element_by_xpath('XPATH ì…ë ¥').click()
```

<br/>

- ì „ì²´ ì½”ë“œ

```py
from selenium import webdriver
from selenium.webdriver.common.alert import Alert

# í˜ì´ì§€ ë¶ˆëŸ¬ì˜¤ê¸°
driver = webdriver.Chrome('í¬ë¡¬ ë“œë¼ì´ë²„ì˜ ì ˆëŒ€ ê²½ë¡œ')
url = 'https://portal.sejong.ac.kr/jsp/login/loginSSL.jsp?rtUrl=blackboard.sejong.ac.kr'
driver.get(url)

# ë¡œê·¸ì¸
driver.find_element_by_name('chkNos').click()
da = Alert(driver) # ì•Œë¦¼ ì°½ ì œì–´
da.accept()
driver.find_element_by_name('id').send_keys('') # id ì…ë ¥í•˜ê¸°
driver.find_element_by_name('password').send_keys('') # pw ì…ë ¥í•˜ê¸°
driver.find_element_by_xpath('//*[@id="loginBtn"]').click() # ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­
```

<br/>

## 3. ì½”ìŠ¤ ê³¼ëª© ê°€ì ¸ì˜¤ê¸°

- ì½”ìŠ¤ ë¦¬ìŠ¤íŠ¸ê°€ load ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê¸°

```py
try: # load ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê¸°
    element = WebDriverWait(driver, 20).until(EC.presence_of_element_located((By.CLASS_NAME, "course-org-list")))
finally:
    pass
```

í´ë˜ìŠ¤ ì´ë¦„ì´ `corse-org-list`ì¸ elementê°€ loadë  ë•Œê¹Œì§€ 20ì´ˆê°„ ê¸°ë‹¤ë ¤ì¤€ë‹¤.  
í•˜ì§€ë§Œ ì„¸ì¢…ëŒ€í•™êµ ë¸”ë™ë³´ë“œ ì½”ìŠ¤ëŠ” ë³´ì´ëŠ” ê³¼ëª©ë§Œ loadë˜ê¸° ë•Œë¬¸ì— ìŠ¤í¬ë¡¤ ë‹¤ìš´ì„ í•´ì¤˜ì•¼ í•œë‹¤.

<br/>

```py
body = driver.find_element_by_css_selector('body')
body.click()

for i in range(8):
    body.send_keys(Keys.PAGE_DOWN)
    
time.sleep(2) # ìŠ¤í¬ë¡¤ í›„ì— load ë  ë•Œê¹Œì§€ 2ì´ˆ ê¸°ë‹¤ë¦¬ê¸°
```

<br/>

- ê° ì½”ìŠ¤ì˜ ID ê°’ ì•Œì•„ë‚´ê¸°

```py
course_list_raw = driver.find_elements_by_class_name("course-element-card")
course_list = []
course_detail_base = "https://blackboard.sejong.ac.kr/webapps/blackboard/execute/announcement?method=search&context=course_entry&course_id="
course_detail_list = []

for i in course_list_raw:
    course_each_id = str(i.get_attribute("data-course-id"))
    course_list.append(course_each_id)
    course_each_url = course_detail_base + course_each_id + "&handle=announcements_entry&mode=view";
    course_detail_list.append([course_each_url])
print(course_detail_list)
```


ëª¨ë“  ê³¼ëª©ì˜ ë§í¬ê°€ `https://blackboard.sejong.ac.kr/webapps/blackboard/execute/announcement?method=search&context=course_entry&course_id=*ID ê°’*&handle=announcements_entry&mode=view`ì˜ í˜•ì‹ìœ¼ë¡œ ë˜ì–´ìˆê¸° ë•Œë¬¸ì— ê° ì½”ìŠ¤ì˜ ID ê°’ì„ ì•Œì•„ë‚´ì•¼ í•œë‹¤.  
<br/>
ID ê°’ì€ `course-element-card` í´ë˜ìŠ¤ë¥¼ ê°€ì§„ elementì˜ id ê°’ì´ë‹¤ !  
ì•Œì•„ë‚¸ ê°’ìœ¼ë¡œ urlì„ ë§Œë“¤ì–´ listì— ë„£ìœ¼ë©´ ëœë‹¤.

<br/>

- ì „ì²´ ì½”ë“œ

```py
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time

try: # load ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê¸°
    element = WebDriverWait(driver, 20).until(EC.presence_of_element_located((By.CLASS_NAME, "course-org-list")))
finally:
    pass

body = driver.find_element_by_css_selector('body')
body.click()

for i in range(8):
    body.send_keys(Keys.PAGE_DOWN)
    
time.sleep(2)

course_list_raw = driver.find_elements_by_class_name("course-element-card")
course_list = []
course_detail_base = "https://blackboard.sejong.ac.kr/webapps/blackboard/execute/announcement?method=search&context=course_entry&course_id="
course_detail_list = []

for i in course_list_raw:
    course_each_id = str(i.get_attribute("data-course-id"))
    course_list.append(course_each_id)
    course_each_url = course_detail_base + course_each_id + "&handle=announcements_entry&mode=view";
    course_detail_list.append([course_each_url])
print(course_detail_list)
```

<br/>

## 4. ê° ê³¼ëª©ë³„ ê³µì§€ / ê³¼ì œ í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸°

`bs4`, `beautifulSoup` ì‚¬ìš©

- ê³µì§€ í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸°

ê³µì§€ëŠ” ê³¼ëª© urlê³¼ ë™ì¼í•˜ë‹¤ !

<br/>

- ê³¼ì œ í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸°

```py
from selenium import webdriver # ëª¨ë“ˆ ë¶ˆëŸ¬ì˜¤ê¸°
from bs4 import BeautifulSoup as bs # html íŒŒì‹±ì„ ìœ„í•´
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time

for i in course_detail_list:
    driver.get(i[0])
    try:
        element = WebDriverWait(driver, 20).until(EC.presence_of_element_located((By.ID, "courseMenuPalette_contents")))
                      
        homework_html = driver.find_element_by_xpath('//*[@id="courseMenuPalette_contents"]').get_attribute('innerHTML')
        soup = bs(homework_html, 'html.parser') # htmlì˜ ê´€ì ìœ¼ë¡œ ë¬¸ìì—´ ì´í•´ì‹œí‚¤ê¸° ìœ„í•œ ì½”ë“œ
        nav_bars = soup.find_all('a')
        for bar in nav_bars:
            if str(bar.find('span').text) == 'ê³¼ì œ' or str(bar.find('span').text) == 'Assignments':
                homework_url = 'https://blackboard.sejong.ac.kr' + str(bar['href'])
                i.append(homework_url)

    except Exception as e:
        homework_html = None
        print(e)
        pass
print(course_detail_list)
```

ê³µì§€ì™€ ë‹¬ë¦¬ ê³¼ì œëŠ” ì—†ëŠ” ê³¼ëª©ë„ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ì˜ˆì™¸ ì²˜ë¦¬í•œë‹¤.  

<br/>

## 5. ê° ê³¼ëª©ë³„ ê³µì§€ / ê³¼ì œ í¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°


```py
from selenium import webdriver # ëª¨ë“ˆ ë¶ˆëŸ¬ì˜¤ê¸°
from bs4 import BeautifulSoup as bs # html íŒŒì‹±ì„ ìœ„í•´
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time

for i in course_detail_list:
    driver.get(i[0])
    try:
        # Page Load ê¸°ë‹¤ë¦¬ê¸°
        element = WebDriverWait(driver, 20).until(EC.presence_of_element_located((By.ID, "courseMenuPalette_contents")))

        # ê³µì§€ ê°€ì ¸ì˜¤ê¸°
        announce_raw = driver.page_source
        soup = bs(announce_raw, 'html.parser')
        announcements = soup.select('li.clearfix')[10:] # select(css selector)
        announcements.reverse() # ì˜¤ë˜ëœ ê²ƒë¶€í„° ì°¨ë¡€ë¡œ ë³´ì—¬ì¤Œ
        
        for ann in announcements:
            print(ann.attrs['id'])
            print(ann.text)
            print('---------------')

        # ê³¼ì œë€ì´ ìˆìœ¼ë©´ ê°€ì ¸ì˜¤ê¸°
        homework_html = driver.find_element_by_xpath('//*[@id="courseMenuPalette_contents"]').get_attribute('innerHTML')
        soup = bs(homework_html, 'html.parser')
        nav_bars = soup.find_all('a')
        for bar in nav_bars:
            if str(bar.find('span').text) == 'ê³¼ì œ' or str(bar.find('span').text) == 'Assignments':
                homework_url = 'https://blackboard.sejong.ac.kr' + str(bar['href'])
                i.append(homework_url)
                driver.get(homework_url)
                homework_raw = driver.page_source
                soup = bs(homework_raw, 'html.parser')
                homeworks = soup.select('ul.contentList > li')
                
                for home in homeworks:
                    print(home.attrs['id'])
                    print(home.text)
                    print('---------------')

    except Exception as e:
        homework_html = None
        print(e)
        pass
```

ì´ëŸ° ì‹ìœ¼ë¡œ ë‹¤ë¥¸ ë©”ë‰´ì˜ ì •ë³´ë„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤ !

<br/>

## 6. ìµœì¢… ì½”ë“œ

```py
from selenium import webdriver # ëª¨ë“ˆ ë¶ˆëŸ¬ì˜¤ê¸°
from selenium.webdriver.common.alert import Alert

from bs4 import BeautifulSoup as bs # html íŒŒì‹±ì„ ìœ„í•´
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time

#chrome_options = webdriver.ChromeOptions()
#chrome_options.add_argument("--incognito") # ì‹œí¬ë¦¿ ëª¨ë“œ ê´€ë ¨

driver = webdriver.Chrome('D:/chromedriver')
#, chrome_options=chrome_options # ì‹œí¬ë¦¿ ëª¨ë“œ ê´€ë ¨
driver.implicitly_wait(3)
url = 'https://portal.sejong.ac.kr/jsp/login/loginSSL.jsp?rtUrl=blackboard.sejong.ac.kr'
driver.get(url)

# ë¡œê·¸ì¸

driver.find_element_by_name('chkNos').click()
da = Alert(driver) # ì•Œë¦¼ ì°½ ì œì–´
da.accept()
driver.find_element_by_name('id').send_keys('ID') # id ì…ë ¥í•˜ê¸°
driver.find_element_by_name('password').send_keys('PW') # pw ì…ë ¥í•˜ê¸°
driver.find_element_by_xpath('//*[@id="loginBtn"]').click() # ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­

# ì½”ìŠ¤ ê³¼ëª© ê°€ì ¸ì˜¤ê¸°

try: # load ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê¸°
    element = WebDriverWait(driver, 20).until(EC.presence_of_element_located((By.CLASS_NAME, "course-org-list")))
finally:
    pass

body = driver.find_element_by_css_selector('body')
body.click()

for i in range(8):
    body.send_keys(Keys.PAGE_DOWN)
    
time.sleep(2)

course_list_raw = driver.find_elements_by_class_name("course-element-card")
course_list = []
course_detail_base = "https://blackboard.sejong.ac.kr/webapps/blackboard/execute/announcement?method=search&context=course_entry&course_id="
course_detail_list = []

for i in course_list_raw:
    course_each_id = str(i.get_attribute("data-course-id"))
    course_list.append(course_each_id)
    course_each_url = course_detail_base + course_each_id + "&handle=announcements_entry&mode=view";
    course_detail_list.append([course_each_url])
print(course_detail_list)



# ê° ê³¼ëª©ë³„ ê³µì§€ / ê³¼ì œ í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸° - bs4, beautifulSoup ì‚¬ìš©

# ê³µì§€ëŠ” ê³¼ëª© urlê³¼ ë™ì¼

for i in course_detail_list:
    driver.get(i[0])
    try:
        # Page Load ê¸°ë‹¤ë¦¬ê¸°
        element = WebDriverWait(driver, 20).until(EC.presence_of_element_located((By.ID, "courseMenuPalette_contents")))

        # ê³µì§€ ê°€ì ¸ì˜¤ê¸°
        announce_raw = driver.page_source
        soup = bs(announce_raw, 'html.parser')
        announcements = soup.select('li.clearfix')[10:]
        announcements.reverse()
        
        for ann in announcements:
            print(ann.attrs['id'])
            print(ann.text)
            print('---------------')

        # ê³¼ì œë€ì´ ìˆìœ¼ë©´ ê°€ì ¸ì˜¤ê¸°, ì—†ìœ¼ë©´ ì—ëŸ¬ë°œìƒ -> except
        homework_html = driver.find_element_by_xpath('//*[@id="courseMenuPalette_contents"]').get_attribute('innerHTML')
        soup = bs(homework_html, 'html.parser')
        nav_bars = soup.find_all('a')
        for bar in nav_bars:
            if str(bar.find('span').text) == 'ê³¼ì œ' or str(bar.find('span').text) == 'Assignments':
                homework_url = 'https://blackboard.sejong.ac.kr' + str(bar['href'])
                i.append(homework_url)
                driver.get(homework_url)
                homework_raw = driver.page_source
                soup = bs(homework_raw, 'html.parser')
                homeworks = soup.select('ul.contentList > li')
                
                for home in homeworks:
                    print(home.attrs['id'])
                    print(home.text)
                    print('---------------')

    except Exception as e:
        homework_html = None
        print(e)
        pass


while(True):
    pass
```


